# Chapter 04 테스트 구축하기

## 4.1 자가 테스트 코드의 가치

-   134 모든 테스트를 완전히 자동화하고 그 결과까지 스스로 검사하게 만들자.
-   그래서 회귀 버그 regressin bug를 잡는 데 볓 분 이상 걸린 적이 거의 없다. 주석 확인
-   테스트 스위트는 강력한 버그 검출 도구로, 버그를 찾는 데 걸리는 시간을 대폭 줄여준다.
-   135 : 테스트를 작성하기 가장 좋은 시점은 프로그래밍을 시작하기 전이다.
-   TDD에서는 (처음에는 통과하지 못할) 테스트를 작성하고, 이 테스트를 통과하게끔 코드를 작성하고, 결과 코드를 최대한 깔끔하게 리팩터링하는 과정을 짧은 주기로 반복한다. ~

## 4.2 테스트할 샘플 코드

-   136 지역 province, 수요 demand, 가격 price, 생산지 producer, 수익 full revenue,
    -   생산 부족분 shortfall, 총수익 profit

## 4.3 첫 번째 테스트

-   141 실패해야 할 상황에서는 반드시 실패하게 만들자
-   자주 테스트하라. 작성 중인 코드는 최소한 몇 분 간격으로 테스트하고, 적어도 하루에 한 번은 전체 테스트를 돌려보자.
-   142 : 이 책에서는 Chai 라이브러리르 사용하겠다.
-   개인적으로 assert를 선호하지만 자바스크립트를 다룰 때는 expect를 주로 사용할 것이다.

## 4.4 테스트 추가하기

-   명심하자! 테스트는 위험 요인을 중심으로 작성해야 한다! 테스트의 목적은 현재 혹은 향후에 발생하는 버그를 찾는 데 있다. 따라서 단순히 필드를 읽고 쓰기만 하는 접근자는 테스트할 필요가 없다.

-   완벽하게 만드느라 테스트를 수행하지 못하느니, 불완전한 테스트라도 작성해 실행하는 게 낫다.

-   144 : 테스트 관련 버그 중 가장 지저분한 유형인 '테스트끼리 상호작용하게 하는 공유 픽스처'를 생성하는 원인이 된다.
-   145 : 매번 픽스처를 생성하느라 테스트가 느려지지 않냐고 묻는 사람이 있다.
-   beforeEach 블록의 등장은 내가 표준 픽스처를 사용한다는 사실을 알려준다.

## 4.5 픽스처 수정하기

-   146: 세터는 보통 아주 단순하여 버그가 생길 일도 별로 없으니 잘 테스트하지 않는다.
    -   하지만 Producer의 production() 세터는 좀 복잡한 동작을 수행하기 때문에 테스트해볼 필요가 있다.
-   '해체 teardown' 혹은 청소 cleanup라고 하는 네 번째 단계도 있는데 명시적으로 언급하지 않을 때가 많다.
    -   해체 단계에서는 픽스처를 제거하여 테스트들이 서로 영향을 주지 못하게 막는다. ~
-   일반적으로 it 구문 하나당 검증도 하나씩만 하는 게 좋다.

## 4.6 경계 조건 검사하기

-   148 문제가 생길 가능성이 있는 경계 조건을 생각해보고 그 부분을 집중적으로 테스트하자.
-   150 나는 리팩터링하기 전이라면 이런 테스트를 작성하지 ~ - "어서션 추가하기"
-   어차피 모든 버그를 잡아낼 수는 없다고 생각하여 ~
-   테스트에도 수확 체감 법칙이 적용된다. ~

## 4.7 끝나지 않은 여정

-   이 장에서 보여준 테스트는 단위 테스트 unit test에 해당한다.
-   나는 제품 코드에 못지않게 테스트 스위트도 지속해서 보강한다.
-   버그 리포트를 받으면 가장 먼저 그 버그를 드러내는 단위 테스트부터 작성하자.
-   152 테스트 스위트가 충분한지를 평가하는 기준은 주관적이다.
