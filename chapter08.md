# Chapter 08 가눙 이동

## 8.1 함수 옮기기 Move Function

### 배경

-   278 좋은 소프트웨어 설계의 핵심ㅇ은 모듈화가 얼마나 . 잘되어 있느냐를 뜻하는 모듈성 modularity이다.
    -   모듈성이란 프로그램의 어딘가를 수정하려 할 때 해당 기능과 깊이 관련된 작은 일부만 이해해도 가능하게 해주는 능력이다.
    -   모듈성을 높이려면 서로 연관된 요소들을 함께 묶고, 요소 사이의 연결 관례를 쉽게 찾고 이해할 수 있도록 해야 한다.
-   객체 지향 프로그래밍의 핵심 모듈화 컨텍스트는 클래스다.

### 예시 : 중첩 함수를 최상위로 옮기기 : GPS 추적 기록의 총 거리를 계산하는 함수

-   이처럼 함수를 복사할 때 이름을 달리해주면 코드에서나 머리속에서나 소스 함수와 타깃 함수가 쉽게 구별된다.
-   285 혹시 이 변수를 남겨둬야 한다면 변수 이름을 totalDistanceCache나 distance 정도로 바꿔주면 된다.

### 예시 : 다른 클래스로 옮기기

<br>

## 8.2 필드 옮기기 Move Field

-   280 프로그램의 진짜 힘은 데이터 구조에서 나온다.
    -   주어진 문제에 적합한 데이터 구조를 활용하면 동작 코드는 자연스럽게 단순하고 직관적으로 짜여진다.
-   가장 적합한 데이터 구조를 알아내고자 프로젝트 초기에 분석을 해 결과, 경험과 도메인 주도 설계 같은 기술이 내 능력을 개선해줌을 알아냈다.
-   290 함수에 항상 함께 건네지는 데이터 조각들은 상호 관계가 명확하게 드러나도록 한 레코드에 담는 게 가장 좋다.
-   지금까지의 설명에서 레코드라는 용어를 썼지만, 레코드 대신 클래스나 객체가 와도 똑같다. 클래스는 함수가 곁들여진 레코드라 할 수 있으며, 다른 데이터와 마찬가지로 건강하게 관리돼야 한다.
    -   클래스의 데이터들은 접근자 메서드들 뒤에 캡슐화되어 있으므로 클래스에 곁들여진 메서드들은 데이터를 이리저리 옮기는 작업을 쉽게 해준다.

### 예시

    - 고객 클래스(Customer)와 계약 클래스(CustomerContract)
    - 292 할인율을 수정하는 public 세터를 만들고 싶지는 않아서 세터 속성이 아니라 메서드를 이용했다.

### 예시 : 공유 객체로 이동하기

    -   294 이자율 interest rate을 계좌 acoount 별로 설정
    -   계좌 데이터를 데이터베이스에 보관한다면 먼저 데이터베이스를 확인해서 모든 계좌의 이자율이 계좌 종류에 부합하게 설정되어 있는지 확인해야 한다. 계좌 클래스에 어서션을 추가하는 것도 도움이 된다.

<br>

## 8.3 문장을 함수로 옮기기 Move Statements into Function

### 배경

<br>

## 8.4 문장을 호출한 곳으로 옮기기 Move Statements to Callers

### 배경

-   301 함수는 프로그래머가 쌓아 올리는 추상화의 기본 빌딩 블록이다.
    -   초기에는 응집도 높고 한 가지 일만 수행하던 함수가 어느새 둘 이상의 다른 일을 수행하게 바뀔 수 있다.
-   여러 곳에서 사용하던 기능이 일부 호출자에게는 다르게 동작하도록 바뀌어야 한다면
    -   우선 문장 슬라이드하기를 적용해 달라지는 동작의 함수의 시작 혹은 끝으로 옮긴 다음, 바로 이어서 문장을 호출한 곳으로 옮기기 리팩터링을 적용하면 된다.

<br>

## 8.5 인라인 코드를 함수 호출로 바꾸기 Replace Inline Code with Function Call

-   309 사용 중인 프로그래밍 언어의 표준 라이브러리나 플랫폼 (혹은 프래임워크나 안정화된 서드파티 라이브러리 등)이 제공하는 API를 잘 파악하고 있을수록 이번 리팩터링의 활용 빈도가 높아질 것이다.
    -   보통은 직접 짠 코드보다 라이브러리가 제공하는 API가 더 효율적일 가능성이 크니, 사용 중인 언어와 플랫폼이 버전업될 때 어떤 기능이 새로 생기고 변경되는지를 평소에 잘 챙겨두면 코드를 개선하는 데 많은 도움이 된다. 물론 외부 라이브러리에 지나치게 의존하면 설계 유연성이 떨어지니 처한 상황에 맞게 신중하게 판단해야 한다.

<br>

## 8.6 문장 슬라이드하기 Slide Statements

### 배경

-   310 관련된 코드들이 가까이 모여 있다.
    -   가장 흔한 사례는 변수를 선언하고 사용할 때다.
    -   모든 변수 선언을 함수 첫머리에 모아두는 사람도 있는데, 나는 변수를 처음 사용할 때 선언하는 스타일을 선호한다.
-   관련 코드끼리 모으는 작업은 다른 리팩터링(주로 함수 추출하기)의 준비단계로 자주 행해진다.

### 예시

-   311 요소를 선언하는 곳과 사용하는 곳을 가까이 두기를 좋아하는 나는 선언 코드를 슬라이드하여 처음 사용하는 곳까지 끌어내리는 일을 자주 한다.

### 예시 : 조건문이 있을 때의 슬라이드

### 더 읽을거리

<br>

## 8.7 반복문 쪼개기 Split Loop

### 배경

-   316 종종 반복문 하나에서 두 가지 일을 수행하는 모습을 보게 된다.
    -   각각의 반복문으로 분리해두면 수정할 동작 하나면 이해하면 된다.
-   317 리팩터링과 최적화를 구분하자.
    -   최적화는 코드를 깔끔히 정리한 이후에 수행하자.
    -   반복문을 두 번 실행하는 게 병목이라 밝혀지면 그때 다시 하나로 합치기는 식은 죽 먹기다. (드물다)

### 예시 : 잔체 급여와 가장 어린 나이를 계산하는 코드
